<!DOCTYPE html>
<html lang="en">

<head>
   <script src="js/core/jquery.min.js"></script>
   <script>
      $("head").load("header.html")
      check_loaded_interval = setInterval(function () { //  check if the header.html is successfully loaded. Otherwise, wait.
         console.log("!")
         if (typeof loaded === "undefined") {
            console.log("waiting")
         } else {
            console.log("header loaded")
            //$("#home_content").load("home.html")
            $("nav").load("nav.html")

            clearInterval(check_loaded_interval); $("#loading").hide(); $("#content").show();
            // JS CODING.
            $("#test").text(loaded)
            function loadjscssfile(filename, filetype) {
               if (filetype == "js") { //if filename is a external JavaScript file
                  var fileref = document.createElement('script')
                  fileref.setAttribute("type", "text/javascript")
                  fileref.setAttribute("src", filename)
               }
               else if (filetype == "css") { //if filename is an external CSS file
                  var fileref = document.createElement("link")
                  fileref.setAttribute("rel", "stylesheet")
                  fileref.setAttribute("type", "text/css")
                  fileref.setAttribute("href", filename)
               }
               if (typeof fileref != "undefined")
                  document.getElementsByTagName("head")[0].appendChild(fileref)
            }

            function load_page_by_url() {
               $(".contents").hide();
               if (window.location.href.split("#")[1] === undefined || window.location.href.split("#")[1] === "") {
                  $("#home_content").show();
                  $("#home_content").load("home.html", function () {
                     $.material.init()
                  })
               } else {
                  $("#" + window.location.href.split("#")[1] + "_content").show();
                  if (["missing_value_imputation"].includes(window.location.href.split("#")[1])) {
                     $("#" + window.location.href.split("#")[1] + "_content").load("templates.html", function () {
                        $.material.init()
                     })
                  } else {
                     $("#" + window.location.href.split("#")[1] + "_content").load(window.location.href.split("#")[1] + ".html", function () {
                        console.log("!")
                        $.material.init()
                     })
                  }
               }
               loadjscssfile("js/material-dashboard.js?v=2.1.0", "js") //dynamically load and add this .js file

            }

            // TRY! when click anchor, do not use load. Rather use show and hide.
            load_page_by_url();
            window.addEventListener('hashchange', load_page_by_url, false);
         }
      }, 1000);
   </script>



</head>

<body style="background-color:white" class="off-canvas-sidebar">
   <i class="fas fa-adjust fa-spin" style="font-size:24px" id="loading"></i>
   <div id="content" style="display:none">
      <!-- HTML CODING -->
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-absolute fixed-top text-black"></nav>
      <!-- End Navbar -->
      <div class="wrapper wrapper-full-page">
         <div class="page-header">
            <div class="container" id=''>
               This will send data using AJAX to Python:<br /><br />
               <a href="" id="theButton">Click Me</a>
               <div id="home_content" class='contents'></div>
               <div id="missing_value_imputation_content" class='contents'></div>



            </div>


         </div>
      </div>
   </div>





   <script type="text/javascript">
      // setup some JSON to use
      var cars = [
         { "make": "Porsche", "model": "911S" },
         { "make": "Mercedes-Benz", "model": "220SE" },
         { "make": "Jaguar", "model": "Mark VII" }
      ];

      window.onload = function () {
         // setup the button click
         document.getElementById("theButton").onclick = function () {
            doWork()
         };
      }

      function doWork() {
         // ajax the JSON to the server

         $.ajax({
            type: "POST",
            url: "http://127.0.0.1:8081/receiver",
            data: JSON.stringify(cars),
            contentType: "application/json; charset=utf-8",
            //dataType: "json",
            success: function (data) {
               alert(data);
            },
            failure: function (errMsg) {
               alert(errMsg);
            }
         });


         // stop link reloading the page
         event.preventDefault();
      }
   </script>

</body>

</html>